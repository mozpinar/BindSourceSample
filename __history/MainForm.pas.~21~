unit MainForm;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Buttons, Vcl.Grids, Vcl.StdCtrls,
  Vcl.ExtCtrls, Data.Bind.Components, Data.Bind.ObjectScope, Data.Bind.GenData,
  Data.Bind.EngExt, Vcl.Bind.DBEngExt, Vcl.Bind.Grid, System.Rtti,
  System.Bindings.Outputs, Vcl.Bind.Editors, Data.Bind.Grid,
  uEntities,                       // <<<<<<<
  System.Generics.Collections, Data.DB, Datasnap.DBClient      // <<<<<<<
  ;
type
  TForm1 = class(TForm)
    StringGrid1: TStringGrid;
    btnAdd: TSpeedButton;
    btnEdit: TSpeedButton;
    btnDelete: TSpeedButton;
    Panel1: TPanel;
    edFirstName: TEdit;
    lblFirstName: TLabel;
    edLastName: TEdit;
    lblLastName: TLabel;
    edAge: TEdit;
    lblAge: TLabel;
    btnOk: TButton;
    btnCancel: TButton;
    cbxDBActive: TCheckBox;
    PrototypeBindSource1: TPrototypeBindSource;
    BindingsList1: TBindingsList;
    LinkGridToDataSourcePrototypeBindSource1: TLinkGridToDataSource;
    LinkControlToField1: TLinkControlToField;
    LinkControlToField2: TLinkControlToField;
    LinkControlToField3: TLinkControlToField;
    ClientDataSet1: TClientDataSet;
    procedure PrototypeBindSource1CreateAdapter(Sender: TObject;
      var ABindSourceAdapter: TBindSourceAdapter);
    procedure btnAddClick(Sender: TObject);
    procedure btnEditClick(Sender: TObject);
    procedure btnDeleteClick(Sender: TObject);
    procedure btnOkClick(Sender: TObject);
    procedure btnCancelClick(Sender: TObject);
  private
    { Private declarations }
    fMyPersons: TObjectList<TKisi>;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.btnAddClick(Sender: TObject);
begin
  PrototypeBindSource1.InternalAdapter.Insert;
end;

procedure TForm1.btnCancelClick(Sender: TObject);
begin
  PrototypeBindSource1.InternalAdapter.Cancel;
end;

procedure TForm1.btnDeleteClick(Sender: TObject);
begin
  if PrototypeBindSource1.RecordCount>0 then
    if MessageDlg('Kayýt silinecek emin misiniz?', TMsgDlgType.mtConfirmation, [mbYes, mbNo], 0) = mrYes then
      PrototypeBindSource1.InternalAdapter.Delete;
end;

procedure TForm1.btnEditClick(Sender: TObject);
begin
  if PrototypeBindSource1.RecordCount>0 then
    PrototypeBindSource1.InternalAdapter.Edit;
end;

procedure TForm1.btnOkClick(Sender: TObject);
begin
  if (edFirstName.Text='') or (edLastName.Text='') then
    raise Exception.Create('Ýsim ve Soyisim girilmesi zorunludur!');

  PrototypeBindSource1.InternalAdapter.Post;
end;

procedure TForm1.PrototypeBindSource1CreateAdapter(Sender: TObject;
  var ABindSourceAdapter: TBindSourceAdapter);
begin
  fMyPersons := TObjectList<TKisi>.Create(True);

  fMyPersons.Add(TKisi.Create('Ahmet', 'Abacý', 33));
  fMyPersons.Add(TKisi.Create('Mehmet', 'Görmez', 38));
  fMyPersons.Add(TKisi.Create('Cenk', 'Görmez', 12));
  fMyPersons.Add(TKisi.Create('Hale', 'Görmez', 34));
  fMyPersons.Add(TKisi.Create('Jülide', 'Tekir', 55));
  fMyPersons.Add(TKisi.Create('Timur', 'Allýkaya', 72));
  fMyPersons.Add(TKisi.Create('Demir', 'Demir', 50));
  fMyPersons.Add(TKisi.Create('Aslan', 'Aslan', 99));
  fMyPersons.Add(TKisi.Create('Güler', 'Dolunay', 21));


  // Use TObjectBindSourceAdapter for a single object
  ABindSourceAdapter := TListBindSourceAdapter<TKisi>.Create(Self, FMyPersons, True);
  ABindSourceAdapter.AfterInsert :=
  ABindSourceAdapter.AfterEdit :=
  ABindSourceAdapter.AfterPost :=

end;

end.
